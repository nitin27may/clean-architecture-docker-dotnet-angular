<div class="container mx-auto p-4">
  <div class="max-w-6xl mx-auto">
    <!-- Page Header -->
    <app-page-header
      title="Role Management"
      subtitle="Configure system roles and permissions"
      icon="admin_panel_settings">
    </app-page-header>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- Form Card -->
      <mat-card class="overflow-hidden">
        <div class="bg-surface-container-high px-6 py-4 border-b border-outline-variant">
          <h2 class="text-lg font-semibold m-0 flex items-center gap-2">
            <mat-icon class="text-primary">{{ selectedRole() ? 'edit' : 'add_circle' }}</mat-icon>
            {{ selectedRole() ? 'Edit Role' : 'Add New Role' }}
          </h2>
        </div>
        
        <mat-card-content style="padding: 0;">
          <div class="p-6 pt-8">
            <form [formGroup]="roleForm" (ngSubmit)="saveRole()" class="space-y-6">
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Name</mat-label>
                <input matInput formControlName="name" placeholder="Enter role name">
                @if (roleForm.get('name')?.hasError('required') && roleForm.get('name')?.touched) {
                  <mat-error>Name is required</mat-error>
                }
              </mat-form-field>
              
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Description</mat-label>
                <textarea matInput formControlName="description" placeholder="Enter role description" rows="3"></textarea>
              </mat-form-field>

              <div class="flex justify-end gap-3 pt-4 border-t border-outline-variant">
                @if (selectedRole()) {
                  <button mat-stroked-button type="button" (click)="resetForm()">
                    Cancel
                  </button>
                }
                <button mat-flat-button color="primary" type="submit" [disabled]="roleForm.invalid || loading()">
                  @if (loading()) {
                    <mat-spinner diameter="20" class="inline-block mr-2"></mat-spinner>
                  }
                  {{ selectedRole() ? 'Update' : 'Create' }}
                </button>
              </div>
            </form>
          </div>
        </mat-card-content>
      </mat-card>
      
      <!-- Roles List Card -->
      <mat-card class="overflow-hidden">
        <div class="bg-surface-container-high px-6 py-4 border-b border-outline-variant">
          <h2 class="text-lg font-semibold m-0 flex items-center gap-2">
            <mat-icon class="text-primary">list</mat-icon>
            Roles List
          </h2>
        </div>
        
        <mat-card-content class="p-0">
          @if (loading() && roles().length === 0) {
            <div class="p-4">
              <app-skeleton type="table" [rows]="4" [columns]="3" />
            </div>
          } @else if (roles().length === 0) {
            <app-empty-state
              icon="badge"
              title="No roles available"
              description="Create your first role to get started.">
            </app-empty-state>
          } @else {
            <div class="overflow-x-auto">
              <table mat-table [dataSource]="roles()" class="w-full">
                <ng-container matColumnDef="name">
                  <th mat-header-cell *matHeaderCellDef class="font-semibold">Name</th>
                  <td mat-cell *matCellDef="let role">{{ role.name }}</td>
                </ng-container>
                
                <ng-container matColumnDef="description">
                  <th mat-header-cell *matHeaderCellDef class="font-semibold">Description</th>
                  <td mat-cell *matCellDef="let role">{{ role.description }}</td>
                </ng-container>
                
                <ng-container matColumnDef="actions">
                  <th mat-header-cell *matHeaderCellDef class="font-semibold text-right">Actions</th>
                  <td mat-cell *matCellDef="let role" class="text-right">
                    <button mat-icon-button color="primary" (click)="selectRole(role)" 
                            matTooltip="Edit role" aria-label="Edit role">
                      <mat-icon>edit</mat-icon>
                    </button>
                    <button mat-icon-button color="warn" (click)="deleteRole(role)" 
                            matTooltip="Delete role" aria-label="Delete role">
                      <mat-icon>delete</mat-icon>
                    </button>
                  </td>
                </ng-container>
                
                <tr mat-header-row *matHeaderRowDef="displayedColumns" class="bg-surface-container"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
                    class="hover:bg-surface-container-highest transition-colors"></tr>
              </table>
            </div>
          }
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>